@{
    // Lấy tên trang hiện tại (ví dụ: /Index, /Fish/FishTypes...)
    var curr = ViewContext.RouteData.Values["page"]?.ToString();
    
    // Hàm phụ trợ để trả về class CSS tùy theo trang có đang active hay không
    string GetActiveCls(string path) => curr == path 
        ? "bg-slate-700 text-white border-l-4 border-sky-500" 
        : "text-slate-400 border-transparent hover:bg-slate-700/50 hover:text-white";
}
<button onclick="toggleSidebar()"
    class="fixed top-4 left-4 z-50 p-2 bg-slate-800 text-white rounded-lg shadow-md hover:bg-slate-700 focus:outline-none transition-all duration-300"
    id="sidebarToggleBtn">
    <svg id="icon-menu" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
    </svg>
    <svg id="icon-close" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
    </svg>
</button>

<button onclick="toggleSidebar()" class="fixed top-4 left-4 z-50 p-2 bg-slate-800 text-white rounded-lg shadow-md">
    <svg id="icon-menu" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
    <svg id="icon-close" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
</button>

<aside id="sidebar" class="fixed left-0 top-0 h-full w-20 bg-slate-800 shadow-xl flex flex-col z-40 transition-all duration-300">
    
    <div class="p-6 text-center border-b border-slate-700 mt-12 overflow-hidden">
        <h2 class="text-xl font-bold text-white nav-text hidden">FishCalc</h2>
    </div>

    <nav class="flex-1 mt-4 space-y-1">
        <a asp-page="/Index" class="nav-item flex items-center p-3 transition-all @GetActiveCls("/Index") justify-center">
            <svg class="h-6 w-6 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
            <span class="nav-text ml-3 hidden whitespace-nowrap">Tổng quan</span>
        </a>

        <a asp-page="/Fish/FishTypes" class="nav-item flex items-center p-3 transition-all @GetActiveCls("/Fish/FishTypes") justify-center">
            <svg class="h-6 w-6 shrink-0" fill="currentColor" viewBox="0 0 640 512"><path d="M212.5 205.5C251.7 172.5 304.6 144 368 144C431.4 144 484.3 172.5 523.5 205.5C562.6 238.5 590.4 277.9 604.5 305.3C609.2 314.5 609.2 325.4 604.5 334.6C590.4 362 562.6 401.4 523.5 434.4C484.3 467.5 431.5 495.9 368 495.9C304.5 495.9 251.7 467.4 212.5 434.4C196.3 420.7 182 405.9 169.8 391.3L80.1 443.6C67.6 450.9 51.7 448.9 41.4 438.7C31.1 428.5 29 412.7 36.1 400.1L82 320L36.2 239.9C29 227.3 31.2 211.5 41.5 201.3C51.8 191.1 67.6 189.1 80.2 196.4L169.9 248.7C182.1 234.1 196.4 219.3 212.6 205.6zM480 320C480 302.3 465.7 288 448 288C430.3 288 416 302.3 416 320C416 337.7 430.3 352 448 352C465.7 352 480 337.7 480 320z" /></svg>
            <span class="nav-text ml-3 hidden whitespace-nowrap">Loại Cá</span>
        </a>

        <a asp-page="/Features/ProcessingSetupModel" class="nav-item flex items-center p-3 transition-all @GetActiveCls("/Features/SalaryProcess") justify-center">
            <svg class="h-6 w-6 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            <span class="nav-text ml-3 hidden whitespace-nowrap">Tính Lương</span>
        </a>

        <a asp-page="/Features/Receipt" class="nav-item flex items-center p-3 transition-all @GetActiveCls("/Features/Receipt") justify-center">
            <svg class="h-6 w-6 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
            <span class="nav-text ml-3 hidden whitespace-nowrap">Biên lai</span>
        </a>

        <a asp-page="/Units/Index" class="nav-item flex items-center p-3 transition-all @GetActiveCls("/Units/Index") justify-center">
            <svg class="h-6 w-6 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
            <span class="nav-text ml-3 hidden whitespace-nowrap">Đơn vị</span>
        </a>
    </nav>
</aside>
<script>
    function setSidebarState(shouldOpen) {
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content'); // ID vùng nội dung chính
        const iconMenu = document.getElementById('icon-menu');
        const iconClose = document.getElementById('icon-close');
        const navTexts = document.querySelectorAll('.nav-text');
        const navItems = document.querySelectorAll('.nav-item');

        if (shouldOpen) {
            // --- MỞ SIDEBAR ---
            sidebar.classList.replace('w-20', 'w-64');
            
            navTexts.forEach(el => {
                el.classList.remove('hidden');
                setTimeout(() => el.classList.remove('opacity-0'), 10);
            });

            navItems.forEach(el => {
                el.classList.replace('justify-center', 'justify-start');
            });

            if (mainContent) mainContent.classList.replace('ml-20', 'ml-64');

            iconMenu.classList.add('hidden');
            iconClose.classList.remove('hidden');
        } else {
            // --- ĐÓNG SIDEBAR ---
            sidebar.classList.replace('w-64', 'w-20');
            
            navTexts.forEach(el => {
                el.classList.add('hidden', 'opacity-0');
            });

            navItems.forEach(el => {
                el.classList.replace('justify-start', 'justify-center');
            });

            if (mainContent) mainContent.classList.replace('ml-64', 'ml-20');

            iconMenu.classList.remove('hidden');
            iconClose.classList.add('hidden');
        }
    }

    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        // Nếu hiện tại là w-20 thì tức là đang đóng -> cần Mở (shouldOpen = true)
        const isCurrentlyClosed = sidebar.classList.contains('w-20');
        setSidebarState(isCurrentlyClosed);
    }
</script>